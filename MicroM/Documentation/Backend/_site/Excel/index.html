<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Excel </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Excel ">
    
    
      <link rel="shortcut icon" href="../favicon.ico">
      <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../styles/docfx.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="">
      <meta property="docfx:tocrel" content="">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="excel">Excel</h1>

<p>MicroM provides utilities for working with Excel (<code>.xlsx</code>) spreadsheets via the <a href="xref:MicroM.Excel"><code>MicroM.Excel</code></a> namespace.</p>
<h2 id="reading-spreadsheets">Reading spreadsheets</h2>
<p><code>ExcelReader</code> reads a worksheet stream asynchronously and yields each row as an array of values. The first row is treated as the header and subsequent rows contain typed values based on the cell's data type.</p>
<pre><code class="lang-csharp">await using var stream = File.OpenRead(&quot;data.xlsx&quot;);

await foreach (var row in ExcelReader.ReadExcelAsync(stream, &quot;Sheet1&quot;))
{
    // row[0], row[1], ...
}
</code></pre>
<p>The reader inspects each cell and converts numbers, booleans and dates to <code>double</code>, <code>bool</code> and <code>DateTime</code> respectively. If a cell contains a shared string or is empty, the corresponding element remains a <code>string</code> or <code>null</code>.</p>
<h2 id="writing-dataresult-to-excel">Writing <code>DataResult</code> to Excel</h2>
<p><code>DataResult</code> represents tabular results in MicroM. The <code>SaveAsExcelToStreamAsync</code> extension creates an Excel file from a <code>DataResult</code> instance:</p>
<pre><code class="lang-csharp">var data = new DataResult(
    new[] { &quot;Header1&quot;, &quot;Header2&quot; },
    new[] { &quot;string&quot;, &quot;double&quot; });

data.records.Add(new object?[] { &quot;Value1&quot;, 123.45 });

using var stream = new MemoryStream();
await data.SaveAsExcelToStreamAsync(stream, &quot;Sheet1&quot;);
</code></pre>
<p>The extension writes the headers and records to a worksheet, handling null, numeric, boolean and date values appropriately. The resulting workbook can later be parsed using <code>ExcelReader</code>.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/mcurros2/MicroMFramework/blob/Codex/MicroM/Documentation/Backend/Excel/index.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
